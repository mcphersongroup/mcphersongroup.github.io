<!-- 
This file contains the conference map and calendar for the research page.
To edit conference information:
1. Find the 'conferences' list in the first Python code block below
2. Add, remove, or modify conference entries following the existing format
3. Each conference needs: name, location, lat, lon, start_date, end_date, type, and url
4. The map and table will automatically update based on this data

This file is included in research/index.qmd and renders at the bottom of the research page.
-->

## Conference Map and Calendar

### Upcoming Conferences and Events

```{python}
#| echo: false
#| warning: false

from ipyleaflet import Map, Marker, AwesomeIcon, Popup
from ipywidgets import HTML
import datetime

# Create a map centered on North America
m = Map(center=(39.8283, -98.5795), zoom=4)

# Conference data - locations, dates, and details
conferences = [
    {
        "name": "AAAS Annual Meeting",
        "location": "Boston, MA",
        "lat": 42.3601,
        "lon": -71.0589,
        "start_date": "2025-02-13",
        "end_date": "2025-02-16",
        "type": "Conference",
        "url": "https://www.aaas.org/meetings"
    },
    {
        "name": "ASM Microbe",
        "location": "Atlanta, GA",
        "lat": 33.7490,
        "lon": -84.3880,
        "start_date": "2025-06-12",
        "end_date": "2025-06-16",
        "type": "Conference",
        "url": "https://asm.org/events/asm-microbe"
    },
    {
        "name": "ASPET Annual Meeting",
        "location": "Philadelphia, PA",
        "lat": 39.9526,
        "lon": -75.1652,
        "start_date": "2025-04-05",
        "end_date": "2025-04-08",
        "type": "Conference",
        "url": "https://www.aspet.org/meetings-events/aspet-annual-meeting"
    },
    {
        "name": "ASV Annual Meeting",
        "location": "Madison, WI",
        "lat": 43.0731,
        "lon": -89.4012,
        "start_date": "2025-07-12",
        "end_date": "2025-07-16",
        "type": "Conference",
        "url": "https://www.asv.org/annual-meeting"
    },
    {
        "name": "British Pharmacological Society Annual Meeting",
        "location": "London, UK",
        "lat": 51.5074,
        "lon": -0.1278,
        "start_date": "2025-12-16",
        "end_date": "2025-12-18",
        "type": "Conference",
        "url": "https://www.bps.ac.uk/events"
    },
    {
        "name": "TMC AMR Conference",
        "location": "Houston, TX",
        "lat": 29.7174,
        "lon": -95.4018,
        "start_date": "2025-09-15",
        "end_date": "2025-09-17",
        "type": "Conference",
        "url": "https://www.tmc.edu/"
    },
    {
        "name": "IDSA IDWeek",
        "location": "Los Angeles, CA",
        "lat": 34.0522,
        "lon": -118.2437,
        "start_date": "2025-10-16",
        "end_date": "2025-10-19",
        "type": "Conference",
        "url": "https://www.idweek.org/"
    },
    {
        "name": "IMARI Conference",
        "location": "Boston, MA",
        "lat": 42.3601,
        "lon": -71.0589,
        "start_date": "2025-11-10",
        "end_date": "2025-11-13",
        "type": "Conference",
        "url": "https://www.imariconference.org/"
    },
    {
        "name": "ASHP Midyear Clinical Meeting",
        "location": "New Orleans, LA",
        "lat": 29.9511,
        "lon": -90.0715,
        "start_date": "2025-12-07",
        "end_date": "2025-12-11",
        "type": "Conference",
        "url": "https://www.ashp.org/meetings-and-events"
    },
    {
        "name": "IUPHAR World Congress",
        "location": "Edinburgh, UK",
        "lat": 55.9533,
        "lon": -3.1883,
        "start_date": "2026-07-13",
        "end_date": "2026-07-17",
        "type": "Conference",
        "url": "https://www.iuphar.org/"
    }
]

# Add markers for each conference location
for conf in conferences:
    icon = AwesomeIcon(
        name='calendar',
        marker_color='red',
        icon_color='white'
    )
    marker = Marker(
        location=(conf["lat"], conf["lon"]),
        draggable=False,
        title=conf["name"],
        icon=icon
    )
    
    # Format dates for display
    start = datetime.datetime.strptime(conf["start_date"], "%Y-%m-%d").strftime("%B %d, %Y")
    end = datetime.datetime.strptime(conf["end_date"], "%Y-%m-%d").strftime("%B %d, %Y")
    
    # Add URL link if available
    url_html = f"<br><a href='{conf['url']}' target='_blank' style='color: #007bff;'>Website</a>" if 'url' in conf else ""
    
    marker.popup = HTML(
        value=f"<div style='width: 200px;'><b>{conf['name']}</b><br><i>{conf['type']}</i><br>{conf['location']}<br>{start} - {end}{url_html}</div>"
    )
    m.add_layer(marker)

m
```

### Conference Calendar

```{python}
#| echo: false
#| warning: false

import pandas as pd
from datetime import datetime

# Create a DataFrame for the conference calendar
calendar_data = []
for conf in conferences:
    start = datetime.strptime(conf["start_date"], "%Y-%m-%d")
    end = datetime.strptime(conf["end_date"], "%Y-%m-%d")
    duration = (end - start).days + 1
    
    calendar_data.append({
        "Event": conf["name"],
        "Type": conf["type"],
        "Location": conf["location"],
        "Start Date": start.strftime("%B %d, %Y"),
        "End Date": end.strftime("%B %d, %Y"),
        "Duration (days)": duration,
        "URL": conf.get("url", "")
    })

df = pd.DataFrame(calendar_data)

# Display as a styled table
from IPython.display import display, HTML

def create_calendar_html(df):
    html = """
    <style>
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .calendar-table thead tr {
            background-color: #007bff;
            color: white;
            text-align: left;
            font-weight: bold;
        }
        .calendar-table th,
        .calendar-table td {
            padding: 12px 15px;
            border: 1px solid #ddd;
        }
        .calendar-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }
        .calendar-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }
        .calendar-table tbody tr:hover {
            background-color: #e3f2fd;
            cursor: pointer;
        }
        .event-type {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .type-conference {
            background-color: #4CAF50;
            color: white;
        }
        .type-summit {
            background-color: #FF9800;
            color: white;
        }
        .type-symposium {
            background-color: #2196F3;
            color: white;
        }
        .type-workshop {
            background-color: #9C27B0;
            color: white;
        }
    </style>
    <table class="calendar-table">
        <thead>
            <tr>
                <th>Event Name</th>
                <th>Type</th>
                <th>Location</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Duration</th>
                <th>Website</th>
            </tr>
        </thead>
        <tbody>
    """
    
    for _, row in df.iterrows():
        type_class = f"type-{row['Type'].lower()}"
        url_link = f"<a href='{row['URL']}' target='_blank' style='color: #007bff;'>Visit</a>" if row['URL'] else "N/A"
        html += f"""
            <tr>
                <td><strong>{row['Event']}</strong></td>
                <td><span class="event-type {type_class}">{row['Type']}</span></td>
                <td>{row['Location']}</td>
                <td>{row['Start Date']}</td>
                <td>{row['End Date']}</td>
                <td>{row['Duration (days)']} days</td>
                <td>{url_link}</td>
            </tr>
        """
    
    html += """
        </tbody>
    </table>
    """
    return html

display(HTML(create_calendar_html(df)))
```
